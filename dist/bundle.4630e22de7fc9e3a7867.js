(()=>{"use strict";var e={634:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(476),n=s.n(r)()((function(e){return e[1]}));n.push([e.id,".dashboard{width:80vw;height:80vh;border:1px solid grey}.delete{margin-right:12px}.message{margin:5px}.showMessage__block{width:80vw;height:2rem;border:1px solid grey}\n",""]);const o=n},476:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=e(t);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(n[i]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&n[c[0]]||(s&&(c[2]?c[2]="".concat(s," and ").concat(c[2]):c[2]=s),t.push(c))}},t}},892:e=>{var t=[];function s(e){for(var s=-1,r=0;r<t.length;r++)if(t[r].identifier===e){s=r;break}return s}function r(e,r){for(var o={},i=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],d=o[l]||0,h="".concat(l," ").concat(d);o[l]=d+1;var u=s(h),p={css:c[1],media:c[2],sourceMap:c[3]};-1!==u?(t[u].references++,t[u].updater(p)):t.push({identifier:h,updater:n(p,r),references:1}),i.push(h)}return i}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var o=r(e=e||[],n=n||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var a=s(o[i]);t[a].references--}for(var c=r(e,n),l=0;l<o.length;l++){var d=s(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},311:e=>{var t={};e.exports=function(e,s){var r=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(s)}},60:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t),t}},192:(e,t,s)=>{e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},760:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var r=s.css,n=s.media,o=s.sourceMap;n?e.setAttribute("media",n):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},865:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,s),o.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=s(892),t=s.n(e),r=s(760),n=s.n(r),o=s(311),i=s.n(o),a=s(192),c=s.n(a),l=s(60),d=s.n(l),h=s(865),u=s.n(h),p=s(634),m={};m.styleTagTransform=u(),m.setAttributes=c(),m.insert=i().bind(null,"head"),m.domAPI=n(),m.insertStyleElement=d(),t()(p.Z,m),p.Z&&p.Z.locals&&p.Z.locals;class g{constructor(e){this.$el="string"==typeof e?document.querySelector(e):e}get data(){return this.$el.dataset}get value(){return this.$el.value}get getText(){return this.$el.textContent}html(e){return"string"==typeof e?(this.$el.innerHTML=e,this):this.$el.outerHTML.trim()}innerHTML(e){return this.$el.innerHTML=e,this}textContent(e){return this.$el.textContent=e,this}insertAdjacentHTML(e="",t){this.$el.insertAdjacentHTML(e,t)}on(e,t){this.$el.addEventListener(e,t)}append(e){return e instanceof g&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}css(e={}){Object.keys(e).forEach((t=>{this.$el.styles[t]=e[t]}))}find(e){return f(this.$el.querySelector(e))}closest(e){return f(this.$el.closest(e))}}function f(e){return new g(e)}f.create=(e,t="",s="")=>{const r=document.createElement(e);return t&&("string"!=typeof t?r.classList.add(...t):r.classList.add(t)),s&&(r.id=s),f(r)};class v{constructor(){this.users={}}register(e){this.users[e.name]=e,e.room=this,console.log(e)}send(e,t,s){s?this.users[s].receive(e,t):Object.keys(this.users).forEach((s=>{this.users[s]!==t&&this.users[s].receive(e,t)}))}}class y{constructor(){this.storage=[],this.name="storage",this.room=null}send(e,t){this.room.send(e,this,t)}receive(e,t){console.log(e),"string"==typeof e?this.addToStorage(e):this.changeStorage(e),this.send(this.storage)}changeStorage(e){this.storage=e}addToStorage(e){this.storage.push({text:e,delete:!1,id:Date.now()})}}class b extends class{constructor(e,t=[]){if(!e)throw new Error("no root provided for DomListner");this.$root=e,this.listeners=t}initDOMListners(){this.listeners.forEach((e=>{const t="on"+("string"!=typeof(s=e)?"":s.charAt(0).toUpperCase()+s.slice(1));var s;if(console.log(t),!this[t])throw new Error(`Method ${t} is not implemented in ${this.name||""} component`);this[t]=this[t].bind(this),this.$root.on(e,this[t])}))}}{constructor(e,t={}){super(e,t.listeners),this.name=t.name||"noName"}init(){this.initDOMListners()}}const M=new class{constructor(e,t){this.$el=f(e),this.components=t.components||[],this.mediator=t.mediator||[],this.storageRoom=new v,this.storage=new y}getRoot(){const e=f.create("div","app");return this.components=this.components.map((t=>{const s=f.create("div",t.className),r=new t(s);return this.storageRoom.register(r),s.html(r.toHTML()),e.append(s),r})),e}render(){this.storageRoom.register(this.storage),this.$el.append(this.getRoot()),this.components.forEach((e=>{e.init()}))}}("#start",{components:[class extends b{static className="showMessage__block";constructor(e){super(e,{name:"lineMessage",listeners:["click"]}),this.messageArr=[]}toHTML(){return'\n        <div class="lineMessage__elements"><button data-type="delete">X</button><span class="lineMessage"></span> </div>\n        '}changeHTML(){const e=f(document.querySelector(".lineMessage"));let t=[];function s(t,s){e.innerHTML(`\n            <span data-type="massegeInLine" data-index="${s}" data-id="${t.id}">${t.text}</span>\n            `)}let r=0;this.messageArr.forEach((e=>{e.delete||t.push(e)}));const n=t.length;0===n?e.innerHTML(""):1===n?s(t[0],0):this.refreshIntervalId=setInterval((function(){s(t[r],r),r++,r>=n&&(r=0)}),2e3)}onClick(e){if("delete"===f(e.target).data.type){const e=f(document.querySelector('[data-type="massegeInLine"]')),t=Number(e.data.id);Number(e.data.index),this.messageArr.forEach((e=>{e.id===t&&(e.delete=!0)}))}clearInterval(this.refreshIntervalId),this.changeHTML(),this.send(this.messageArr)}send(e,t){this.room.send(e,this,"storage")}receive(e,t){console.log(e),this.messageArr=e,console.log(this.messageArr),clearInterval(this.refreshIntervalId),this.changeHTML()}},class extends b{static className="dashboard__block";constructor(e){super(e,{name:"dashBoard",listeners:["click"]}),this.room=null,this.messageArr=[]}toHTML(){return'\n  <div class="dashboard">\n  \n</div>\n    '}changeHTML(){const e=f(document.querySelector(".dashboard"));e.innerHTML(""),this.messageArr.forEach(((t,s)=>{console.log(t);let r=f.create("div","message");const n=!0===this.messageArr[s].delete?"x ":"";r.innerHTML(`<span data-id="${s}">${n}</span><span class="text">${this.messageArr[s].text}</span>`),e.append(r)}))}onClick(){}send(e,t){this.room.send(e,this,t)}receive(e,t){this.messageArr=e,this.changeHTML()}},class extends b{static className="input__block";constructor(e){super(e,{name:"inputMessage",listeners:["click"]}),this.room=null,this.register=!0,this.observer=[Storage],this.actions=[]}toHTML(){return'\n    <input data-type="inputValue">\n    <button data-type="send">write</button>\n    '}onClick(e){"send"===f(e.target).data.type&&this.getData()}send(e,t){this.room.send(e,this,"storage")}receive(e,t){}getData(){const e=document.querySelector('[data-type="inputValue"]');this.send(e.value)}}],mediator:[v]});M.render()})()})();